<% cache brewery do %>

<div id="<%= dom_id brewery %>">
   <h2>
    <%= brewery.name %>
    <% if not brewery.active  %>
      <span class="badge bg-secondary">retired</span>
    <% end %>
  </h2>
  <p><i>Established in <%= brewery.year %></i></p>
  <p>Beer count: <%=@brewery.beers.count %></p>

<h3>Beers</h3>  
<div>
  <table class="table table-hover">
    <tr>
      <th>Name</th>
      <th>Style</th>
      <th>Rating</th>
    </tr>
    <% brewery.beers.each do |beer| %>
      <tr>
        <td><%= link_to beer.name, beer %></td>
        <td><%= link_to beer.style.name, beer.style %></td>
        <td><%= beer.average_rating %></td>
      </tr>
    <% end %>
  </table>
</div>

 <p>
    <% if brewery.ratings.empty? %>
    <% else %>
      Brewery has <%= pluralize(brewery.ratings.size, "rating") %> with an average of <%= brewery.average_rating%>
    <% end %>
  </p>

</div>

<% end %>